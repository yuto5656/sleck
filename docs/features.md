# Sleck 機能仕様書

## 1. 認証機能

### 1.1 ユーザー登録
- メールアドレス、パスワード、表示名での登録
- パスワード要件:
  - 8文字以上
- メールアドレスの重複チェック
- 登録完了後、自動ログイン

### 1.2 ログイン
- メールアドレス + パスワード認証

### 1.3 ログアウト
- セッション破棄
- WebSocket切断

### 1.4 パスワードリセット
- 管理者がパスワードリセットリンクを生成
- ユーザーは管理者から受け取ったリンクでパスワードを再設定
- リンク有効期限: 1時間

---

## 2. ワークスペース機能

### 2.1 ワークスペース
- シングルワークスペース構成（1つのワークスペースのみ）
- デフォルトで `#general` チャンネルが存在

### 2.2 ユーザー管理（Admin のみ）
- ユーザー一覧表示
- ユーザーの役割変更（admin/deputy_admin/member）
- パスワードリセットリンク生成
- オープン登録（誰でもアカウント作成可能）

### 2.3 役割と権限

| 権限 | Admin | Deputy Admin | Member |
|------|-------|--------------|--------|
| ワークスペース設定変更 | ✓ | - | - |
| ユーザー管理 | ✓ | - | - |
| パスワードリセットリンク生成 | ✓ | - | - |
| チャンネル作成 | ✓ | ✓ | - |
| チャンネル削除 | ✓ | ✓ | - |
| メッセージ送信 | ✓ | ✓ | ✓ |

※ Admin は1名のみ（システム管理者）

---

## 3. チャンネル機能

### 3.1 チャンネル一覧
- パブリックチャンネル表示
- 参加中のプライベートチャンネル表示
- 未読メッセージ数表示
- 最終メッセージのプレビュー

### 3.2 チャンネル作成
- チャンネル名（# なしで入力、自動付与）
- 説明（オプション）
- Admin / Deputy Admin のみ作成可能
- 作成者は自動的に参加

※ プライベートチャンネル機能は未実装

### 3.3 チャンネル名の規則
- 小文字英数字とハイフンのみ
- 80文字以内
- ワークスペース内で一意

### 3.4 チャンネル参加/退出
- 全チャンネルに全ユーザーが自動参加
- 退出機能は未実装

### 3.5 チャンネル設定
- チャンネル削除（Admin / Deputy Admin のみ）
- General チャンネルは削除不可

---

## 4. メッセージ機能

### 4.1 メッセージ送信
- テキスト入力（Enterで送信、Shift+Enterで改行）
- Markdown対応:
  - **太字** (`**text**`)
  - *斜体* (`*text*`)
  - ~~取り消し線~~ (`~~text~~`)
  - `インラインコード` (`` `code` ``)
  - コードブロック（```言語名）
  - 引用（> text）
  - リスト（- item）
  - リンク自動検出

### 4.2 メッセージ表示
- ユーザーアバター
- 表示名
- タイムスタンプ
- 編集済みマーク
- リアクション表示

### 4.3 メッセージ編集
- 自分のメッセージのみ編集可能
- 編集履歴は保持しない
- 「編集済み」マーク表示

### 4.4 メッセージ削除
- 自分のメッセージ: 削除可能
- 他人のメッセージ: 管理者のみ削除可能
- 「このメッセージは削除されました」表示

### 4.5 スレッド
- 任意のメッセージに返信可能
- スレッド内メッセージ数表示
- 最新返信時刻表示
- スレッド展開表示

---

## 5. リアクション機能

### 5.1 リアクション追加
- 絵文字ピッカーから選択
- よく使う絵文字のショートカット
- 同じ絵文字は1ユーザー1つまで

### 5.2 リアクション表示
- メッセージ下部に絵文字+カウント表示
- ホバーでリアクションしたユーザー一覧
- クリックでリアクション追加/削除トグル

---

## 6. ファイル共有機能

### 6.1 アップロード
- ドラッグ&ドロップ対応
- クリックでファイル選択
- クリップボードからペースト（画像）
- 複数ファイル同時アップロード

### 6.2 対応形式
- 画像: jpg, png, gif, webp, svg
- 文書: pdf, doc, docx, xls, xlsx, ppt, pptx
- その他: txt, md, json, csv, zip

### 6.3 制限
- 最大サイズ: 10MB/ファイル
- 1メッセージあたり最大: 10ファイル

### 6.4 プレビュー
- 画像: インライン表示（クリックで拡大）
- その他: アイコン + ファイル名 + サイズ

---

## 7. ダイレクトメッセージ機能

### 7.1 DM開始
- ユーザー検索からDM開始
- ユーザープロフィールからDM開始

### 7.2 DM一覧
- 最新メッセージ順でソート
- 未読カウント表示
- オンラインステータス表示

### 7.3 DMメッセージ
- チャンネルと同等の機能
- リアクション
- ファイル共有
- スレッドなし

---

## 8. 検索機能

### 8.1 グローバル検索
- メッセージ本文
- ファイル名
- ユーザー名
- チャンネル名

### 8.2 検索フィルター
※ 検索フィルター機能は未実装（将来対応予定）

### 8.3 検索結果
- ハイライト表示
- コンテキスト表示
- 該当メッセージへジャンプ

---

## 9. メンション機能

### 9.1 メンション種類
- `@username` - 個人メンション
- `@channel` - チャンネル全員
- `@here` - オンラインメンバー全員

### 9.2 メンション入力
- `@` 入力で候補表示
- キーボードナビゲーション
- Tab/Enterで確定

### 9.3 メンション通知
- メンションされると通知
- メンション箇所のハイライト

---

## 10. 通知機能

### 10.1 通知種類
- メンション通知
- DM通知

### 10.2 通知表示
- アプリ内通知パネル
- 未読カウント表示

### 10.3 通知設定
※ 通知設定機能は未実装（将来対応予定）

---

## 11. ユーザープロフィール機能

### 11.1 プロフィール情報
- アバター画像
- 表示名
- メールアドレス
- ステータス（オンライン/離席中/取り込み中/オフライン）
- カスタムステータスメッセージ

### 11.2 プロフィール編集
- アバター変更（アップロード/削除）
- 表示名変更
- ステータスメッセージ設定

### 11.3 オンラインステータス
- 自動検出（アクティビティベース）
- 手動設定可能
- ステータス表示:
  - 🟢 オンライン
  - 🟡 離席中
  - 🔴 取り込み中
  - ⚪ オフライン

---

## 12. UI/UX仕様

### 12.1 レイアウト

```
┌─────────────────────────────────────────────────────────────┐
│ Header (ワークスペース名, 検索バー, ユーザーメニュー)        │
├────────────┬──────────────────────────────────┬─────────────┤
│            │                                  │             │
│ Sidebar    │         Main Content             │   Detail    │
│            │                                  │   Panel     │
│ - Channels │  - Message List                  │   (Thread/  │
│ - DMs      │  - Message Input                 │   Profile)  │
│ - Users    │                                  │             │
│            │                                  │             │
├────────────┴──────────────────────────────────┴─────────────┤
│ (Mobile: Tab Navigation)                                     │
└─────────────────────────────────────────────────────────────┘
```

### 12.2 レスポンシブ対応
- デスクトップ: 3カラムレイアウト
- タブレット: 2カラム（サイドバー折りたたみ）
- モバイル: 1カラム + ボトムナビゲーション

### 12.3 キーボードショートカット

| ショートカット | 動作 |
|---------------|------|
| Ctrl/Cmd + K | 検索を開く |
| Ctrl/Cmd + N | 新規メッセージ |
| Ctrl/Cmd + / | ショートカット一覧 |
| Esc | パネルを閉じる |
| ↑ | 最後のメッセージを編集 |

### 12.4 テーマ
- ライトモード
- ダークモード
- システム設定に従う

---

## 13. PWA対応

### 13.1 インストール
- Chrome/Edgeでアドレスバーの「インストール」ボタンからインストール可能
- iOS SafariでShare→「ホーム画面に追加」でインストール可能
- Android Chromeでメニュー→「ホーム画面に追加」でインストール可能

### 13.2 機能
- スタンドアロンモード（ブラウザUIなしで起動）
- アプリアイコン（ホーム画面/タスクバー）
- 静的アセットのキャッシュ（高速な再読み込み）

### 13.3 制限
- オフライン時はメッセージの送受信不可（リアルタイム通信が必要なため）
- プッシュ通知は未対応（将来対応予定）
